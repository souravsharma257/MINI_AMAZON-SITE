{% extends "shop/base.html" %}
{% block content %}
<div class="container">
  <aside class="sidebar">
    <h3>Categories</h3>
    <ul>
      <li><a href="/">All Categories</a></li>
      <li><a href="?category=Electronics">Electronics</a></li>
      <li><a href="?category=Fashion">Fashion</a></li>
      <li><a href="?category=Books">Books</a></li>
      <li><a href="?category=Home">Home</a></li>
    </ul>
  </aside>

  <main class="products-section">
    {% if query %}
      <h2>Search Results for "{{ query }}"</h2>
    {% else %}
      <h2>Products</h2>
    {% endif %}
    
    <div class="product-grid">
      {% for product in products %}
      <div class="product-card">
        <img src="{{ product.image.url }}" alt="{{ product.name }}"/>
        <h3>{{ product.name }}</h3>
        <p class="price">₹{{ product.price }}</p>
        <a href="{% url 'product_detail' product.pk %}" class="view-btn">View</a>
        
        {% if user.is_authenticated %}
          <a href="{% url 'add_to_wishlist' product.pk %}" class="wishlist-link">
            {% if wishlist_products and product in wishlist_products %}
              ❤️ Remove from Wishlist
            {% else %}
              ♡ Add to Wishlist
            {% endif %}
          </a>
        {% else %}
          <small><a href="{% url 'login' %}" class="login-link">Login to add to Wishlist</a></small>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    
    {% if not products %}
      <p class="no-products">No products found. Try a different search!</p>
    {% endif %}
  </main>
</div>
{% endblock %}